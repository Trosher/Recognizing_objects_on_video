2024-02-21 01:00:20.173 | INFO     | __main__:__create_log_file:46 - /app/ubuntu/app/src/logs/server_yolo_analys_log/runtime_server_yolo_analys_2024-2-21-1-0-20.log
2024-02-21 01:00:20.174 | INFO     | __main__:start:111 - Start server_yolo_analys
2024-02-21 01:01:21.786 | INFO     | pyspark.sql.utils:call:117 - An error has been caught in function 'call', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o52, 1]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
> File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 1
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1bec790>
    │    │    │         └ JavaObject id=o52
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 100, in __analys_frame
    data_collect = batch_df.collect()
                   │        └ <function DataFrame.collect at 0x7f509dcdab60>
                   └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]

  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/dataframe.py", line 1257, in collect
    sock_info = self._jdf.collectToPython()
                │    └ JavaObject id=o52
                └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]
  File "/usr/local/lib/python3.11/dist-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   └ <function capture_sql_exception.<locals>.deco at 0x7f50b1b30cc0>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           │  │    └ {}
           │  └ ('xro56', <py4j.clientserver.JavaClient object at 0x7f509e6afb90>, 'o52', 'collectToPython')
           └ <function get_return_value at 0x7f509e1963e0>
  File "/usr/local/lib/python3.11/dist-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
          └ <class 'py4j.protocol.Py4JJavaError'>

py4j.protocol.Py4JJavaError: An error occurred while calling o52.collectToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times, most recent failure: Lost task 0.0 in stage 0.0 (TID 0) (bc9d71c20da4 executor driver): java.lang.IllegalStateException: Cannot fetch offset 1782 (GroupId: spark-kafka-source-0402ebf1-c8cd-415a-9023-95171c3ce716-1231091028-executor, TopicPartition: frame_to_analyze-0). 
Some data may have been lost because they are not available in Kafka any more; either the
 data was aged out by Kafka or the topic may have been deleted before all the data in the
 topic was processed. If you don't want your streaming query to fail on such cases, set the
 source option "failOnDataLoss" to "false".
    
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer$.org$apache$spark$sql$kafka010$consumer$KafkaDataConsumer$$reportDataLoss0(KafkaDataConsumer.scala:724)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.reportDataLoss(KafkaDataConsumer.scala:651)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:344)
	at org.apache.spark.util.UninterruptibleThread.runUninterruptibly(UninterruptibleThread.scala:77)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.runUninterruptiblyIfPossible(KafkaDataConsumer.scala:656)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.get(KafkaDataConsumer.scala:299)
	at org.apache.spark.sql.kafka010.KafkaBatchPartitionReader.next(KafkaBatchPartitionReader.scala:79)
	at org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:120)
	at org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:158)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1$adapted(DataSourceRDD.scala:63)
	at scala.Option.exists(Option.scala:376)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.advanceToNextIter(DataSourceRDD.scala:97)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.kafka.clients.consumer.OffsetOutOfRangeException: Fetch position FetchPosition{offset=1782, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.18.0.3:29092 (id: 1 rack: null)], epoch=0}} is out of range for partition frame_to_analyze-0
	at org.apache.kafka.clients.consumer.internals.Fetcher.handleOffsetOutOfRange(Fetcher.java:1408)
	at org.apache.kafka.clients.consumer.internals.Fetcher.initializeCompletedFetch(Fetcher.java:1360)
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:659)
	at org.apache.kafka.clients.consumer.KafkaConsumer.pollForFetches(KafkaConsumer.java:1314)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1243)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1216)
	at org.apache.spark.sql.kafka010.consumer.InternalKafkaConsumer.fetch(KafkaDataConsumer.scala:78)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$fetchData$1(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.timeNanos(KafkaDataConsumer.scala:666)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchData(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchRecord(KafkaDataConsumer.scala:502)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:323)
	... 37 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:448)
	at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:4160)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4334)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:546)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:4332)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:4332)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:4157)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.sendCommand(ClientServerConnection.java:244)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:384)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:356)
	at py4j.reflection.PythonProxyHandler.invoke(PythonProxyHandler.java:106)
	at com.sun.proxy.$Proxy30.call(Unknown Source)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1$adapted(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.ForeachBatchSink.addBatch(ForeachBatchSink.scala:34)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$17(MicroBatchExecution.scala:732)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:286)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:249)
	at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:239)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$1(StreamExecution.scala:311)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:289)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)
Caused by: java.lang.IllegalStateException: Cannot fetch offset 1782 (GroupId: spark-kafka-source-0402ebf1-c8cd-415a-9023-95171c3ce716-1231091028-executor, TopicPartition: frame_to_analyze-0). 
Some data may have been lost because they are not available in Kafka any more; either the
 data was aged out by Kafka or the topic may have been deleted before all the data in the
 topic was processed. If you don't want your streaming query to fail on such cases, set the
 source option "failOnDataLoss" to "false".
    
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer$.org$apache$spark$sql$kafka010$consumer$KafkaDataConsumer$$reportDataLoss0(KafkaDataConsumer.scala:724)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.reportDataLoss(KafkaDataConsumer.scala:651)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:344)
	at org.apache.spark.util.UninterruptibleThread.runUninterruptibly(UninterruptibleThread.scala:77)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.runUninterruptiblyIfPossible(KafkaDataConsumer.scala:656)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.get(KafkaDataConsumer.scala:299)
	at org.apache.spark.sql.kafka010.KafkaBatchPartitionReader.next(KafkaBatchPartitionReader.scala:79)
	at org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:120)
	at org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:158)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1$adapted(DataSourceRDD.scala:63)
	at scala.Option.exists(Option.scala:376)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.advanceToNextIter(DataSourceRDD.scala:97)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.kafka.clients.consumer.OffsetOutOfRangeException: Fetch position FetchPosition{offset=1782, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.18.0.3:29092 (id: 1 rack: null)], epoch=0}} is out of range for partition frame_to_analyze-0
	at org.apache.kafka.clients.consumer.internals.Fetcher.handleOffsetOutOfRange(Fetcher.java:1408)
	at org.apache.kafka.clients.consumer.internals.Fetcher.initializeCompletedFetch(Fetcher.java:1360)
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:659)
	at org.apache.kafka.clients.consumer.KafkaConsumer.pollForFetches(KafkaConsumer.java:1314)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1243)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1216)
	at org.apache.spark.sql.kafka010.consumer.InternalKafkaConsumer.fetch(KafkaDataConsumer.scala:78)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$fetchData$1(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.timeNanos(KafkaDataConsumer.scala:666)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchData(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchRecord(KafkaDataConsumer.scala:502)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:323)
	... 37 more

2024-02-21 01:01:34.504 | INFO     | pyspark.sql.utils:call:117 - An error has been caught in function 'call', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o68, 2]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
> File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 2
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5f610>
    │    │    │         └ JavaObject id=o68
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 100, in __analys_frame
    data_collect = batch_df.collect()
                   │        └ <function DataFrame.collect at 0x7f509dcdab60>
                   └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]

  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/dataframe.py", line 1257, in collect
    sock_info = self._jdf.collectToPython()
                │    └ JavaObject id=o68
                └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]
  File "/usr/local/lib/python3.11/dist-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   └ <function capture_sql_exception.<locals>.deco at 0x7f509c2ba0c0>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           │  │    └ {}
           │  └ ('xro72', <py4j.clientserver.JavaClient object at 0x7f509e6afb90>, 'o68', 'collectToPython')
           └ <function get_return_value at 0x7f509e1963e0>
  File "/usr/local/lib/python3.11/dist-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
          └ <class 'py4j.protocol.Py4JJavaError'>

py4j.protocol.Py4JJavaError: An error occurred while calling o68.collectToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 2) (bc9d71c20da4 executor driver): java.lang.IllegalStateException: Cannot fetch offset 1788 (GroupId: spark-kafka-source-0402ebf1-c8cd-415a-9023-95171c3ce716-1231091028-executor, TopicPartition: frame_to_analyze-0). 
Some data may have been lost because they are not available in Kafka any more; either the
 data was aged out by Kafka or the topic may have been deleted before all the data in the
 topic was processed. If you don't want your streaming query to fail on such cases, set the
 source option "failOnDataLoss" to "false".
    
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer$.org$apache$spark$sql$kafka010$consumer$KafkaDataConsumer$$reportDataLoss0(KafkaDataConsumer.scala:724)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.reportDataLoss(KafkaDataConsumer.scala:651)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:344)
	at org.apache.spark.util.UninterruptibleThread.runUninterruptibly(UninterruptibleThread.scala:77)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.runUninterruptiblyIfPossible(KafkaDataConsumer.scala:656)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.get(KafkaDataConsumer.scala:299)
	at org.apache.spark.sql.kafka010.KafkaBatchPartitionReader.next(KafkaBatchPartitionReader.scala:79)
	at org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:120)
	at org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:158)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1$adapted(DataSourceRDD.scala:63)
	at scala.Option.exists(Option.scala:376)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.advanceToNextIter(DataSourceRDD.scala:97)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.kafka.clients.consumer.OffsetOutOfRangeException: Fetch position FetchPosition{offset=1788, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.18.0.3:29092 (id: 1 rack: null)], epoch=0}} is out of range for partition frame_to_analyze-0
	at org.apache.kafka.clients.consumer.internals.Fetcher.handleOffsetOutOfRange(Fetcher.java:1408)
	at org.apache.kafka.clients.consumer.internals.Fetcher.initializeCompletedFetch(Fetcher.java:1360)
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:659)
	at org.apache.kafka.clients.consumer.KafkaConsumer.pollForFetches(KafkaConsumer.java:1314)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1243)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1216)
	at org.apache.spark.sql.kafka010.consumer.InternalKafkaConsumer.fetch(KafkaDataConsumer.scala:78)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$fetchData$1(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.timeNanos(KafkaDataConsumer.scala:666)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchData(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchRecord(KafkaDataConsumer.scala:502)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:323)
	... 37 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:448)
	at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:4160)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4334)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:546)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:4332)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:4332)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:4157)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.sendCommand(ClientServerConnection.java:244)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:384)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:356)
	at py4j.reflection.PythonProxyHandler.invoke(PythonProxyHandler.java:106)
	at com.sun.proxy.$Proxy30.call(Unknown Source)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1$adapted(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.ForeachBatchSink.addBatch(ForeachBatchSink.scala:34)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$17(MicroBatchExecution.scala:732)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:286)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:249)
	at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:239)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$1(StreamExecution.scala:311)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:289)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)
Caused by: java.lang.IllegalStateException: Cannot fetch offset 1788 (GroupId: spark-kafka-source-0402ebf1-c8cd-415a-9023-95171c3ce716-1231091028-executor, TopicPartition: frame_to_analyze-0). 
Some data may have been lost because they are not available in Kafka any more; either the
 data was aged out by Kafka or the topic may have been deleted before all the data in the
 topic was processed. If you don't want your streaming query to fail on such cases, set the
 source option "failOnDataLoss" to "false".
    
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer$.org$apache$spark$sql$kafka010$consumer$KafkaDataConsumer$$reportDataLoss0(KafkaDataConsumer.scala:724)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.reportDataLoss(KafkaDataConsumer.scala:651)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:344)
	at org.apache.spark.util.UninterruptibleThread.runUninterruptibly(UninterruptibleThread.scala:77)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.runUninterruptiblyIfPossible(KafkaDataConsumer.scala:656)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.get(KafkaDataConsumer.scala:299)
	at org.apache.spark.sql.kafka010.KafkaBatchPartitionReader.next(KafkaBatchPartitionReader.scala:79)
	at org.apache.spark.sql.execution.datasources.v2.PartitionIterator.hasNext(DataSourceRDD.scala:120)
	at org.apache.spark.sql.execution.datasources.v2.MetricsIterator.hasNext(DataSourceRDD.scala:158)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.$anonfun$hasNext$1$adapted(DataSourceRDD.scala:63)
	at scala.Option.exists(Option.scala:376)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.advanceToNextIter(DataSourceRDD.scala:97)
	at org.apache.spark.sql.execution.datasources.v2.DataSourceRDD$$anon$1.hasNext(DataSourceRDD.scala:63)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at org.apache.spark.sql.execution.SparkPlan.$anonfun$getByteArrayRdd$1(SparkPlan.scala:388)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:890)
	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:890)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: org.apache.kafka.clients.consumer.OffsetOutOfRangeException: Fetch position FetchPosition{offset=1788, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[172.18.0.3:29092 (id: 1 rack: null)], epoch=0}} is out of range for partition frame_to_analyze-0
	at org.apache.kafka.clients.consumer.internals.Fetcher.handleOffsetOutOfRange(Fetcher.java:1408)
	at org.apache.kafka.clients.consumer.internals.Fetcher.initializeCompletedFetch(Fetcher.java:1360)
	at org.apache.kafka.clients.consumer.internals.Fetcher.collectFetch(Fetcher.java:659)
	at org.apache.kafka.clients.consumer.KafkaConsumer.pollForFetches(KafkaConsumer.java:1314)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1243)
	at org.apache.kafka.clients.consumer.KafkaConsumer.poll(KafkaConsumer.java:1216)
	at org.apache.spark.sql.kafka010.consumer.InternalKafkaConsumer.fetch(KafkaDataConsumer.scala:78)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$fetchData$1(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.timeNanos(KafkaDataConsumer.scala:666)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchData(KafkaDataConsumer.scala:579)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.fetchRecord(KafkaDataConsumer.scala:502)
	at org.apache.spark.sql.kafka010.consumer.KafkaDataConsumer.$anonfun$get$1(KafkaDataConsumer.scala:323)
	... 37 more

2024-02-21 01:02:05.748 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o84, 3]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 3
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c3596d0>
    │    │    │         └ JavaObject id=o84
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:08.405 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o89, 4]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 4
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31fb50>
    │    │    │         └ JavaObject id=o89
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:08.508 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o89, 4]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 4
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31fb50>
    │    │    │         └ JavaObject id=o89
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:09.259 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o94, 5]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 5
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6c90>
    │    │    │         └ JavaObject id=o94
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:09.363 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o94, 5]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 5
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6c90>
    │    │    │         └ JavaObject id=o94
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:09.459 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o94, 5]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 5
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6c90>
    │    │    │         └ JavaObject id=o94
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:09.559 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o94, 5]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 5
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6c90>
    │    │    │         └ JavaObject id=o94
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:10.286 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o99, 6]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 6
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5d590>
    │    │    │         └ JavaObject id=o99
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:11.018 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o104, 7]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 7
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6c90>
    │    │    │         └ JavaObject id=o104
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:11.505 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o109, 8]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 8
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afe350>
    │    │    │         └ JavaObject id=o109
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:12.248 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o114, 9]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 9
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c359990>
    │    │    │         └ JavaObject id=o114
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:13.045 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o119, 10]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 10
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35bb90>
    │    │    │         └ JavaObject id=o119
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:13.788 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o124, 11]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 11
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35a010>
    │    │    │         └ JavaObject id=o124
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:14.560 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o129, 12]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 12
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35b710>
    │    │    │         └ JavaObject id=o129
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:15.314 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o134, 13]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 13
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35a1d0>
    │    │    │         └ JavaObject id=o134
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=174...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:16.053 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o139, 14]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 14
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c366090>
    │    │    │         └ JavaObject id=o139
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:16.775 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o144, 15]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 15
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c366110>
    │    │    │         └ JavaObject id=o144
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:17.515 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o149, 16]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 16
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c366850>
    │    │    │         └ JavaObject id=o149
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:18.220 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o154, 17]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 17
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367110>
    │    │    │         └ JavaObject id=o154
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:18.929 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o159, 18]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 18
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c366850>
    │    │    │         └ JavaObject id=o159
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:19.737 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o164, 19]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 19
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c364550>
    │    │    │         └ JavaObject id=o164
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:20.478 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o169, 20]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 20
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a9b310>
    │    │    │         └ JavaObject id=o169
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:21.304 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o174, 21]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 21
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35a1d0>
    │    │    │         └ JavaObject id=o174
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:22.036 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o179, 22]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 22
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c368150>
    │    │    │         └ JavaObject id=o179
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:22.782 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o184, 23]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 23
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36aa10>
    │    │    │         └ JavaObject id=o184
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:23.545 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o189, 24]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 24
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1bca850>
    │    │    │         └ JavaObject id=o189
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:24.352 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o194, 25]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 25
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36b5d0>
    │    │    │         └ JavaObject id=o194
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:25.097 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o199, 26]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 26
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36b610>
    │    │    │         └ JavaObject id=o199
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:25.829 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o204, 27]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 27
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36bc90>
    │    │    │         └ JavaObject id=o204
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:26.636 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o209, 28]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 28
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36bd50>
    │    │    │         └ JavaObject id=o209
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:27.397 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o214, 29]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 29
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f5850>
    │    │    │         └ JavaObject id=o214
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:28.164 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o219, 30]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 30
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36b210>
    │    │    │         └ JavaObject id=o219
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:29.397 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o224, 31]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 31
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36b990>
    │    │    │         └ JavaObject id=o224
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:30.114 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o229, 32]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 32
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c368350>
    │    │    │         └ JavaObject id=o229
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:30.804 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o234, 33]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 33
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36a4d0>
    │    │    │         └ JavaObject id=o234
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:31.516 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o239, 34]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 34
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c364f50>
    │    │    │         └ JavaObject id=o239
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:32.224 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o244, 35]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 35
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367890>
    │    │    │         └ JavaObject id=o244
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=180...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:32.975 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o249, 36]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 36
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afc290>
    │    │    │         └ JavaObject id=o249
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:33.768 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o254, 37]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 37
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1affd10>
    │    │    │         └ JavaObject id=o254
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:34.593 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o259, 38]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 38
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367650>
    │    │    │         └ JavaObject id=o259
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:35.366 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o264, 39]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 39
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c369fd0>
    │    │    │         └ JavaObject id=o264
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:36.193 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o269, 40]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 40
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367650>
    │    │    │         └ JavaObject id=o269
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:36.984 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o274, 41]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 41
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367310>
    │    │    │         └ JavaObject id=o274
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:37.788 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o279, 42]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 42
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1b8ca90>
    │    │    │         └ JavaObject id=o279
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:38.586 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o284, 43]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 43
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31fe50>
    │    │    │         └ JavaObject id=o284
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=175...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:39.406 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o289, 44]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 44
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afed50>
    │    │    │         └ JavaObject id=o289
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:40.162 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o294, 45]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 45
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6550>
    │    │    │         └ JavaObject id=o294
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:40.980 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o299, 46]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 46
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6f90>
    │    │    │         └ JavaObject id=o299
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:41.778 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o304, 47]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 47
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509e3d5d10>
    │    │    │         └ JavaObject id=o304
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:42.554 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o309, 48]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 48
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35bcd0>
    │    │    │         └ JavaObject id=o309
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:43.350 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o314, 49]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 49
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f5390>
    │    │    │         └ JavaObject id=o314
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:44.204 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o319, 50]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 50
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1b70510>
    │    │    │         └ JavaObject id=o319
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:44.991 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o324, 51]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 51
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31ff50>
    │    │    │         └ JavaObject id=o324
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:45.740 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o329, 52]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 52
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35a9d0>
    │    │    │         └ JavaObject id=o329
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:46.541 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o334, 53]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 53
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6890>
    │    │    │         └ JavaObject id=o334
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:47.334 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o339, 54]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 54
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c364190>
    │    │    │         └ JavaObject id=o339
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=181...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:48.137 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o344, 55]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 55
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509e0ce7d0>
    │    │    │         └ JavaObject id=o344
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:48.937 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o349, 56]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 56
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1b8ca90>
    │    │    │         └ JavaObject id=o349
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:49.711 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o354, 57]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 57
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6f10>
    │    │    │         └ JavaObject id=o354
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:50.519 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o359, 58]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 58
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b4181a90>
    │    │    │         └ JavaObject id=o359
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:51.323 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o364, 59]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 59
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c368c10>
    │    │    │         └ JavaObject id=o364
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:52.101 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o369, 60]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 60
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36be50>
    │    │    │         └ JavaObject id=o369
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:52.914 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o374, 61]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 61
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31ff10>
    │    │    │         └ JavaObject id=o374
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:53.703 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o379, 62]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 62
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6b10>
    │    │    │         └ JavaObject id=o379
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:54.500 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o384, 63]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 63
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6b50>
    │    │    │         └ JavaObject id=o384
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=176...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:55.310 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o389, 64]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 64
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36b250>
    │    │    │         └ JavaObject id=o389
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:56.085 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o394, 65]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 65
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6510>
    │    │    │         └ JavaObject id=o394
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:56.882 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o399, 66]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 66
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6b10>
    │    │    │         └ JavaObject id=o399
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:57.665 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o404, 67]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 67
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c366410>
    │    │    │         └ JavaObject id=o404
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:58.451 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o409, 68]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 68
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36aed0>
    │    │    │         └ JavaObject id=o409
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:02:59.257 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o414, 69]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 69
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f4290>
    │    │    │         └ JavaObject id=o414
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:00.067 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o419, 70]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 70
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35ad90>
    │    │    │         └ JavaObject id=o419
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:00.857 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o424, 71]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 71
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f5910>
    │    │    │         └ JavaObject id=o424
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:01.653 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o429, 72]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 72
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c36af90>
    │    │    │         └ JavaObject id=o429
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:02.471 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o434, 73]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 73
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afd390>
    │    │    │         └ JavaObject id=o434
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:03.264 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o439, 74]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 74
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afe110>
    │    │    │         └ JavaObject id=o439
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=182...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:04.048 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o444, 75]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 75
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35aa90>
    │    │    │         └ JavaObject id=o444
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:04.853 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o449, 76]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 76
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35a190>
    │    │    │         └ JavaObject id=o449
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:05.632 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o454, 77]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 77
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1aff910>
    │    │    │         └ JavaObject id=o454
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:06.446 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o459, 78]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 78
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509fb3aed0>
    │    │    │         └ JavaObject id=o459
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:07.249 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o464, 79]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 79
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50a0570490>
    │    │    │         └ JavaObject id=o464
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:08.037 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o469, 80]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 80
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a9b010>
    │    │    │         └ JavaObject id=o469
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:08.830 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o474, 81]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 81
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f6dd0>
    │    │    │         └ JavaObject id=o474
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:09.633 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o479, 82]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 82
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c9da10>
    │    │    │         └ JavaObject id=o479
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:10.423 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o484, 83]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 83
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50a05a9ad0>
    │    │    │         └ JavaObject id=o484
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:11.268 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o489, 84]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 84
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c9ef90>
    │    │    │         └ JavaObject id=o489
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=177...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:12.066 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o494, 85]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 85
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509e8aee50>
    │    │    │         └ JavaObject id=o494
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:12.831 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o499, 86]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 86
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5e710>
    │    │    │         └ JavaObject id=o499
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:13.619 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o504, 87]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 87
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5c8d0>
    │    │    │         └ JavaObject id=o504
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:14.411 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o509, 88]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 88
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c9ed10>
    │    │    │         └ JavaObject id=o509
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:15.166 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o514, 89]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 89
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c9e310>
    │    │    │         └ JavaObject id=o514
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:15.947 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o519, 90]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 90
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a98350>
    │    │    │         └ JavaObject id=o519
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:16.818 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o524, 91]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 91
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1aff690>
    │    │    │         └ JavaObject id=o524
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:17.550 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o529, 92]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 92
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50a05727d0>
    │    │    │         └ JavaObject id=o529
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=183...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:18.367 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o534, 93]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 93
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c31ff10>
    │    │    │         └ JavaObject id=o534
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:19.155 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o539, 94]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 94
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35b750>
    │    │    │         └ JavaObject id=o539
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:19.976 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o544, 95]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 95
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35ae10>
    │    │    │         └ JavaObject id=o544
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:20.754 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o549, 96]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 96
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a9ad90>
    │    │    │         └ JavaObject id=o549
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.send("processed_images", key=url.encode(), value=link)
    │                                            │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                            └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:21.627 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o554, 97]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 97
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c364ed0>
    │    │    │         └ JavaObject id=o554
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:22.353 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o559, 98]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 98
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5edd0>
    │    │    │         └ JavaObject id=o559
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:23.150 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o564, 99]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 99
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367110>
    │    │    │         └ JavaObject id=o564
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:23.942 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o569, 100]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 100
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afe490>
    │    │    │         └ JavaObject id=o569
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:24.763 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o574, 101]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 101
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50584f5d10>
    │    │    │         └ JavaObject id=o574
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:25.549 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o579, 102]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 102
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c367010>
    │    │    │         └ JavaObject id=o579
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:26.403 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o584, 103]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 103
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a982d0>
    │    │    │         └ JavaObject id=o584
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:27.166 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o589, 104]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 104
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1afd350>
    │    │    │         └ JavaObject id=o589
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:27.963 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o594, 105]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 105
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a9be10>
    │    │    │         └ JavaObject id=o594
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:28.753 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o599, 106]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 106
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c369f50>
    │    │    │         └ JavaObject id=o599
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=178...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:29.555 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o604, 107]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 107
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c2e6610>
    │    │    │         └ JavaObject id=o604
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:30.395 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o609, 108]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 108
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1a9b2d0>
    │    │    │         └ JavaObject id=o609
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=1, offset=179...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:31.173 | INFO     | __main__:__analys_frame:104 - An error has been caught in function '__analys_frame', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o614, 109]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 109
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f50b1c5ddd0>
    │    │    │         └ JavaObject id=o614
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 104, in __analys_frame
    self.__picture_recognition(data_row["key"], frame_id, m.unpackb(self.__redis.get(frame_id)))
    │                          │                │         │ │       │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          │                │         │ │       └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    │                          │                │         │ └ <function unpackb at 0x7f517a186700>
    │                          │                │         └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                          │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                          └ Row(key=None, value=bytearray(b'http://211.132.61.124:80/mjpg/video.mjpg'), topic='frame_to_analyze', partition=0, offset=184...
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 85, in __picture_recognition
    self.__producer.set("processed_images", key=url.encode(), value=link)
    │                                           │                   └ b'http://211.132.61.124:80/mjpg/video.mjpg'
    │                                           └ None
    └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>

AttributeError: 'cimpl.Producer' object has no attribute 'send'
2024-02-21 01:03:31.663 | INFO     | asyncio.events:_run:80 - An error has been caught in function '_run', process 'MainProcess' (30391), thread 'MainThread' (139988624297984):
Traceback (most recent call last):

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 120, in <module>
    run(sya.start())
    │   │   └ <function server_yolo_analys.start at 0x7f509dbe36a0>
    │   └ <__main__.server_yolo_analys object at 0x7f509dbec5d0>
    └ <function run at 0x7f51a3e12c00>

  File "/usr/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object server_yolo_analys.start at 0x7f50b1bc4140>
           │      └ <function Runner.run at 0x7f51a3789440>
           └ <asyncio.runners.Runner object at 0x7f509e162e90>
  File "/usr/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<server_yolo_analys.start() running at /usr/local/lib/python3.11/dist-packages/loguru/_logge...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f51a3787060>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f509e162e90>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f51a3786fc0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f51a3788e00>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f51a3e13420>
    └ <Handle <TaskStepMethWrapper object at 0x7f518fe79510>()>
> File "/usr/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x7f518fe79510>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x7f518fe79510>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x7f518fe79510>()>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 116, in start
    query.awaitTermination()
    │     └ <function StreamingQuery.awaitTermination at 0x7f509dc9bd80>
    └ <pyspark.sql.streaming.query.StreamingQuery object at 0x7f50b1afd610>

  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/streaming/query.py", line 221, in awaitTermination
    return self._jsq.awaitTermination()
           │    └ JavaObject id=o46
           └ <pyspark.sql.streaming.query.StreamingQuery object at 0x7f50b1afd610>
  File "/usr/local/lib/python3.11/dist-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   └ <function capture_sql_exception.<locals>.deco at 0x7f50b1b17880>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           │  │    └ {}
           │  └ ('x', <py4j.clientserver.JavaClient object at 0x7f509e6afb90>, 'o46', 'awaitTermination')
           └ <function get_return_value at 0x7f509e1963e0>
  File "/usr/local/lib/python3.11/dist-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
          └ <class 'py4j.protocol.Py4JError'>

py4j.protocol.Py4JError: An error occurred while calling o46.awaitTermination
2024-02-21 01:03:31.666 | INFO     | __main__:__exit__:50 - End work server_yolo_analys
2024-02-21 01:03:31.736 | INFO     | pyspark.sql.utils:call:117 - An error has been caught in function 'call', process 'MainProcess' (30391), thread 'Thread-4 (run)' (139983104497216):
Traceback (most recent call last):

  File "/usr/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7f51a4045da0>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7f51a4045a80>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    │        │    └ ()
    │    │        └ <Thread(Thread-4 (run), started daemon 139983104497216)>
    │    └ <bound method ClientServerConnection.run of <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>>
    └ <Thread(Thread-4 (run), started daemon 139983104497216)>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 497, in run
    self.wait_for_commands()
    │    └ <function ClientServerConnection.wait_for_commands at 0x7f509decb1a0>
    └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 581, in wait_for_commands
    return_message = self._call_proxy(obj_id, self.stream)
                     │    │           │       │    └ <_io.BufferedReader name=46>
                     │    │           │       └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
                     │    │           └ 'p0'
                     │    └ <function ClientServerConnection._call_proxy at 0x7f509decb240>
                     └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
  File "/usr/local/lib/python3.11/dist-packages/py4j/clientserver.py", line 617, in _call_proxy
    return_value = getattr(self.pool[obj_id], method)(*params)
                           │    │    │        │        └ [JavaObject id=o619, 110]
                           │    │    │        └ 'call'
                           │    │    └ 'p0'
                           │    └ <py4j.java_gateway.PythonProxyPool object at 0x7f509e0ccd10>
                           └ <py4j.clientserver.ClientServerConnection object at 0x7f50b1afd190>
> File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/utils.py", line 117, in call
    self.func(DataFrame(jdf, wrapped_session_jdf), batch_id)
    │    │    │         │    │                     └ 110
    │    │    │         │    └ <pyspark.sql.session.SparkSession object at 0x7f509c35ac10>
    │    │    │         └ JavaObject id=o619
    │    │    └ <class 'pyspark.sql.dataframe.DataFrame'>
    │    └ <bound method server_yolo_analys.__analys_frame of <__main__.server_yolo_analys object at 0x7f509dbec5d0>>
    └ <pyspark.sql.utils.ForeachBatchFunction object at 0x7f50b1bec690>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 100, in __analys_frame
    data_collect = batch_df.collect()
                   │        └ <function DataFrame.collect at 0x7f509dcdab60>
                   └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]

  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/dataframe.py", line 1257, in collect
    sock_info = self._jdf.collectToPython()
                │    └ JavaObject id=o619
                └ DataFrame[key: binary, value: binary, topic: string, partition: int, offset: bigint, timestamp: timestamp, timestampType: int]
  File "/usr/local/lib/python3.11/dist-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   └ <function capture_sql_exception.<locals>.deco at 0x7f50b1b17880>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           │  │    └ {}
           │  └ ('xro623', <py4j.clientserver.JavaClient object at 0x7f509e6afb90>, 'o619', 'collectToPython')
           └ <function get_return_value at 0x7f509e1963e0>
  File "/usr/local/lib/python3.11/dist-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
          └ <class 'py4j.protocol.Py4JJavaError'>

py4j.protocol.Py4JJavaError: An error occurred while calling o619.collectToPython.
: org.apache.spark.SparkException: Job 110 cancelled because SparkContext was shut down
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1(DAGScheduler.scala:1248)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1$adapted(DAGScheduler.scala:1246)
	at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)
	at org.apache.spark.scheduler.DAGScheduler.cleanUpAfterSchedulerStop(DAGScheduler.scala:1246)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onStop(DAGScheduler.scala:3075)
	at org.apache.spark.util.EventLoop.stop(EventLoop.scala:84)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$stop$3(DAGScheduler.scala:2961)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.scheduler.DAGScheduler.stop(DAGScheduler.scala:2961)
	at org.apache.spark.SparkContext.$anonfun$stop$12(SparkContext.scala:2263)
	at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1375)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2263)
	at org.apache.spark.SparkContext.stop(SparkContext.scala:2216)
	at org.apache.spark.api.java.JavaSparkContext.stop(JavaSparkContext.scala:550)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)
	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)
	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)
	at org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:448)
	at org.apache.spark.sql.Dataset.$anonfun$collectToPython$1(Dataset.scala:4160)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$2(Dataset.scala:4334)
	at org.apache.spark.sql.execution.QueryExecution$.withInternalError(QueryExecution.scala:546)
	at org.apache.spark.sql.Dataset.$anonfun$withAction$1(Dataset.scala:4332)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.Dataset.withAction(Dataset.scala:4332)
	at org.apache.spark.sql.Dataset.collectToPython(Dataset.scala:4157)
	at jdk.internal.reflect.GeneratedMethodAccessor54.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.sendCommand(ClientServerConnection.java:244)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:384)
	at py4j.CallbackClient.sendCommand(CallbackClient.java:356)
	at py4j.reflection.PythonProxyHandler.invoke(PythonProxyHandler.java:106)
	at com.sun.proxy.$Proxy30.call(Unknown Source)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.PythonForeachBatchHelper$.$anonfun$callForeachBatch$1$adapted(ForeachBatchSink.scala:53)
	at org.apache.spark.sql.execution.streaming.sources.ForeachBatchSink.addBatch(ForeachBatchSink.scala:34)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$17(MicroBatchExecution.scala:732)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)
	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)
	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runBatch$16(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runBatch(MicroBatchExecution.scala:729)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$2(MicroBatchExecution.scala:286)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken(ProgressReporter.scala:427)
	at org.apache.spark.sql.execution.streaming.ProgressReporter.reportTimeTaken$(ProgressReporter.scala:425)
	at org.apache.spark.sql.execution.streaming.StreamExecution.reportTimeTaken(StreamExecution.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.$anonfun$runActivatedStream$1(MicroBatchExecution.scala:249)
	at org.apache.spark.sql.execution.streaming.ProcessingTimeExecutor.execute(TriggerExecutor.scala:67)
	at org.apache.spark.sql.execution.streaming.MicroBatchExecution.runActivatedStream(MicroBatchExecution.scala:239)
	at org.apache.spark.sql.execution.streaming.StreamExecution.$anonfun$runStream$1(StreamExecution.scala:311)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)
	at org.apache.spark.sql.execution.streaming.StreamExecution.org$apache$spark$sql$execution$streaming$StreamExecution$$runStream(StreamExecution.scala:289)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.$anonfun$run$1(StreamExecution.scala:211)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)
	at org.apache.spark.JobArtifactSet$.withActiveJobArtifactState(JobArtifactSet.scala:94)
	at org.apache.spark.sql.execution.streaming.StreamExecution$$anon$1.run(StreamExecution.scala:211)

