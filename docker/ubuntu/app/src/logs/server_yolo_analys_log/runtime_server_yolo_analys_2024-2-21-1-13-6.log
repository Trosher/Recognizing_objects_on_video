2024-02-21 01:13:06.151 | INFO     | __main__:__create_log_file:47 - /app/ubuntu/app/src/logs/server_yolo_analys_log/runtime_server_yolo_analys_2024-2-21-1-13-6.log
2024-02-21 01:13:06.151 | INFO     | __main__:start:113 - Start server_yolo_analys
2024-02-21 01:14:37.385 | INFO     | asyncio.events:_run:80 - An error has been caught in function '_run', process 'MainProcess' (6587), thread 'MainThread' (139913215139840):
Traceback (most recent call last):

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 122, in <module>
    run(sya.start())
    │   │   └ <function server_yolo_analys.start at 0x7f3f0f007560>
    │   └ <__main__.server_yolo_analys object at 0x7f3f0eff3650>
    └ <function run at 0x7f4015256b60>

  File "/usr/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object server_yolo_analys.start at 0x7f3f0f14fa40>
           │      └ <function Runner.run at 0x7f4014bf53a0>
           └ <asyncio.runners.Runner object at 0x7f3f0eff3690>
  File "/usr/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<server_yolo_analys.start() running at /usr/local/lib/python3.11/dist-packages/loguru/_logge...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f4014bf2fc0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f3f0eff3690>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f4014bf2f20>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f4014bf4d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f4015257380>
    └ <Handle <TaskStepMethWrapper object at 0x7f3f0effe710>()>
> File "/usr/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskStepMethWrapper object at 0x7f3f0effe710>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskStepMethWrapper object at 0x7f3f0effe710>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskStepMethWrapper object at 0x7f3f0effe710>()>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 118, in start
    query.awaitTermination()
    │     └ <function StreamingQuery.awaitTermination at 0x7f3f0f0bbc40>
    └ <pyspark.sql.streaming.query.StreamingQuery object at 0x7f3f26748490>

  File "/usr/local/lib/python3.11/dist-packages/pyspark/sql/streaming/query.py", line 221, in awaitTermination
    return self._jsq.awaitTermination()
           │    └ JavaObject id=o46
           └ <pyspark.sql.streaming.query.StreamingQuery object at 0x7f3f26748490>
  File "/usr/local/lib/python3.11/dist-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   └ <function capture_sql_exception.<locals>.deco at 0x7f3f0f0a8720>
  File "/usr/local/lib/python3.11/dist-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           │  │    └ {}
           │  └ ('x', <py4j.clientserver.JavaClient object at 0x7f3f0f067650>, 'o46', 'awaitTermination')
           └ <function get_return_value at 0x7f3f0f5aa2a0>
  File "/usr/local/lib/python3.11/dist-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
          └ <class 'py4j.protocol.Py4JError'>

py4j.protocol.Py4JError: An error occurred while calling o46.awaitTermination
2024-02-21 01:14:37.390 | INFO     | __main__:__exit__:51 - End work server_yolo_analys
2024-02-21 01:14:37.390 | INFO     | __main__:<module>:121 - An error has been caught in function '<module>', process 'MainProcess' (6587), thread 'MainThread' (139913215139840):
Traceback (most recent call last):

> File "/app/ubuntu/app/src/server_yolo_analys.py", line 121, in <module>
    with server_yolo_analys() as sya:
         │                       └ <__main__.server_yolo_analys object at 0x7f3f0eff3650>
         └ <class '__main__.server_yolo_analys'>

  File "/app/ubuntu/app/src/server_yolo_analys.py", line 52, in __exit__
    self.__consumer.close()
    └ <__main__.server_yolo_analys object at 0x7f3f0eff3650>

AttributeError: 'server_yolo_analys' object has no attribute '_server_yolo_analys__consumer'
