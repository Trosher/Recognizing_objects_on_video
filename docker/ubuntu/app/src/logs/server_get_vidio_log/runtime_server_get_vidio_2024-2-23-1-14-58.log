2024-02-23 01:14:58.447 | INFO     | __main__:__create_log_file:46 - /app/ubuntu/app/src/logs/server_get_vidio_log/runtime_server_get_vidio_2024-2-23-1-14-58.log
2024-02-23 01:14:58.448 | INFO     | __main__:start:113 - Start get_video_server
2024-02-23 01:14:58.448 | INFO     | __main__:__check_urls:95 - Start __check_urls
2024-02-23 01:14:59.449 | INFO     | __main__:__stream_controler:102 - Start __stream_controler
2024-02-23 01:16:22.997 | INFO     | __main__:__stream_controler:105 - http://211.132.61.124:80/mjpg/video.mjpg
2024-02-23 01:16:22.997 | INFO     | __main__:__creater_stream:65 - Start thred for pars url: http://211.132.61.124:80/mjpg/video.mjpg
2024-02-23 01:18:15.884 | INFO     | __main__:__creater_stream:73 - An error has been caught in function '__creater_stream', process 'MainProcess' (224), thread 'MainThread' (140255578062848):
Traceback (most recent call last):

  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 1092, in get_connection
    if connection.can_read():
       │          └ <function AbstractConnection.can_read at 0x7f8f96ffe7a0>
       └ Connection<host=172.18.0.6,port=6379,db=0>
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 478, in can_read
    return self._parser.can_read(timeout)
           │    │       │        └ 0
           │    │       └ <function _RESPBase.can_read at 0x7f8f96f93240>
           │    └ <redis._parsers.resp2._RESP2Parser object at 0x7f8f96d70a10>
           └ Connection<host=172.18.0.6,port=6379,db=0>
  File "/usr/local/lib/python3.11/dist-packages/redis/_parsers/base.py", line 128, in can_read
    return self._buffer and self._buffer.can_read(timeout)
           │    │           │    │                └ 0
           │    │           │    └ None
           │    │           └ <redis._parsers.resp2._RESP2Parser object at 0x7f8f96d70a10>
           │    └ None
           └ <redis._parsers.resp2._RESP2Parser object at 0x7f8f96d70a10>
  File "/usr/local/lib/python3.11/dist-packages/redis/_parsers/socket.py", line 95, in can_read
    return bool(self.unread_bytes()) or self._read_from_socket(
                │    │                  │    └ <function SocketBuffer._read_from_socket at 0x7f8f96f92ac0>
                │    │                  └ <redis._parsers.socket.SocketBuffer object at 0x7f8fcb2bb8d0>
                │    └ <function SocketBuffer.unread_bytes at 0x7f8f96f92a20>
                └ <redis._parsers.socket.SocketBuffer object at 0x7f8fcb2bb8d0>
  File "/usr/local/lib/python3.11/dist-packages/redis/_parsers/socket.py", line 68, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
          │               └ 'Connection closed by server.'
          └ <class 'redis.exceptions.ConnectionError'>

redis.exceptions.ConnectionError: Connection closed by server.


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 264, in connect
    sock = self.retry.call_with_retry(
           │    │     └ <function Retry.call_with_retry at 0x7f8f96fcb560>
           │    └ <redis.retry.Retry object at 0x7f8fa25cabd0>
           └ Connection<host=172.18.0.6,port=6379,db=0>
  File "/usr/local/lib/python3.11/dist-packages/redis/retry.py", line 46, in call_with_retry
    return do()
           └ <function AbstractConnection.connect.<locals>.<lambda> at 0x7f8f96d62840>
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 265, in <lambda>
    lambda: self._connect(), lambda error: self.disconnect(error)
            │    │                         │    └ <function AbstractConnection.disconnect at 0x7f8f96ffe3e0>
            │    │                         └ Connection<host=172.18.0.6,port=6379,db=0>
            │    └ <function Connection._connect at 0x7f8f96ffeb60>
            └ Connection<host=172.18.0.6,port=6379,db=0>
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 627, in _connect
    raise err
          └ ConnectionRefusedError(111, 'Connection refused')
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 615, in _connect
    sock.connect(socket_address)
    │    │       └ ('172.18.0.6', 6379)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=6>

ConnectionRefusedError: [Errno 111] Connection refused


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/ubuntu/app/src/server_get_video.py", line 122, in <module>
    run(ssgv.start())
    │   │    └ <function server_get_vidio.start at 0x7f8f96d623e0>
    │   └ <__main__.server_get_vidio object at 0x7f8f96d64f90>
    └ <function run at 0x7f8fcb41b420>

  File "/usr/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           │      │   └ <coroutine object server_get_vidio.start at 0x7f8f96ebfe40>
           │      └ <function Runner.run at 0x7f8fcb26ad40>
           └ <asyncio.runners.Runner object at 0x7f8f96d65010>
  File "/usr/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<server_get_vidio.start() running at /usr/local/lib/python3.11/dist-packages/loguru/_logger....
           │    │     └ <function BaseEventLoop.run_until_complete at 0x7f8fcb2689a0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x7f8f96d65010>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 640, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x7f8fcb268900>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 607, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x7f8fcb26a700>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/usr/lib/python3.11/asyncio/base_events.py", line 1922, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x7f8fcb3d0cc0>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>
  File "/usr/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future finished result=None>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future finished result=None>)>

> File "/app/ubuntu/app/src/server_get_video.py", line 73, in __creater_stream
    self.__frame_sending(frame, url)
    │                    │      └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    │                    └ array([[[205, 191, 178],
    │                              [205, 191, 178],
    │                              [205, 191, 178],
    │                              ...,
    │                              [182, 171, 160],
    │                              [128...
    └ <__main__.server_get_vidio object at 0x7f8f96d64f90>

  File "/app/ubuntu/app/src/server_get_video.py", line 50, in __frame_sending
    self.__redis.set(url, m.packb(frame))
    │                │    │ │     └ array([[[205, 191, 178],
    │                │    │ │               [205, 191, 178],
    │                │    │ │               [205, 191, 178],
    │                │    │ │               ...,
    │                │    │ │               [182, 171, 160],
    │                │    │ │               [128...
    │                │    │ └ <function packb at 0x7f8f97bf7d80>
    │                │    └ <module 'msgpack_numpy' from '/usr/local/lib/python3.11/dist-packages/msgpack_numpy.py'>
    │                └ 'http://211.132.61.124:80/mjpg/video.mjpg'
    └ <__main__.server_get_vidio object at 0x7f8f96d64f90>

  File "/usr/local/lib/python3.11/dist-packages/redis/commands/core.py", line 2341, in set
    return self.execute_command("SET", *pieces, **options)
           │    │                       │         └ {}
           │    │                       └ ['http://211.132.61.124:80/mjpg/video.mjpg', b'\x85\xc4\x02nd\xc3\xc4\x04type\xa3|u1\xc4\x04kind\xc4\x00\xc4\x05shape\x93\xcd...
           │    └ <function Redis.execute_command at 0x7f8f96efd1c0>
           └ Redis<ConnectionPool<Connection<host=172.18.0.6,port=6379,db=0>>>
  File "/usr/local/lib/python3.11/dist-packages/redis/client.py", line 533, in execute_command
    conn = self.connection or pool.get_connection(command_name, **options)
           │    │             │    │              │               └ {}
           │    │             │    │              └ 'SET'
           │    │             │    └ <function ConnectionPool.get_connection at 0x7f8f96fff740>
           │    │             └ ConnectionPool<Connection<host=172.18.0.6,port=6379,db=0>>
           │    └ None
           └ Redis<ConnectionPool<Connection<host=172.18.0.6,port=6379,db=0>>>
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 1096, in get_connection
    connection.connect()
    │          └ <function AbstractConnection.connect at 0x7f8f96ffe0c0>
    └ Connection<host=172.18.0.6,port=6379,db=0>
  File "/usr/local/lib/python3.11/dist-packages/redis/connection.py", line 270, in connect
    raise ConnectionError(self._error_message(e))
          │               │    └ <function Connection._error_message at 0x7f8f96ffeca0>
          │               └ Connection<host=172.18.0.6,port=6379,db=0>
          └ <class 'redis.exceptions.ConnectionError'>

redis.exceptions.ConnectionError: Error 111 connecting to 172.18.0.6:6379. Connection refused.
